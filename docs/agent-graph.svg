<svg xmlns="http://www.w3.org/2000/svg" width="900" height="900" viewBox="0 0 900 900">
  <defs>
    <style>
      .box { fill: #f8fafc; stroke: #4f46e5; stroke-width: 2; rx: 10; }
      .title { font: bold 20px Arial, sans-serif; fill: #111827; }
      .label { font: 14px Arial, sans-serif; fill: #111827; }
      .small { font: 12px Arial, sans-serif; fill: #374151; }
      .arrow { stroke: #111827; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .loop { stroke: #dc2626; stroke-width: 2; fill: none; marker-end: url(#arrowhead-red); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#111827" />
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#dc2626" />
    </marker>
  </defs>

  <rect x="20" y="20" width="860" height="860" fill="#ffffff" stroke="#e5e7eb" />
  <text x="40" y="55" class="title">FinSight LangGraph Agent Flow (Top to Bottom)</text>

  <rect class="box" x="360" y="90" width="180" height="60" />
  <text x="405" y="125" class="label">START</text>

  <rect class="box" x="360" y="180" width="180" height="70" />
  <text x="390" y="210" class="label">supervisor</text>
  <text x="390" y="230" class="small">route decision</text>

  <rect class="box" x="360" y="290" width="180" height="70" />
  <text x="380" y="320" class="label">intake_guard</text>
  <text x="380" y="340" class="small">validate profile</text>

  <rect class="box" x="360" y="400" width="180" height="70" />
  <text x="420" y="430" class="label">frame</text>
  <text x="410" y="450" class="small">LLM framing</text>

  <rect class="box" x="360" y="510" width="180" height="70" />
  <text x="430" y="540" class="label">web</text>
  <text x="410" y="560" class="small">news search</text>

  <rect class="box" x="360" y="620" width="180" height="70" />
  <text x="410" y="650" class="label">yfinance</text>
  <text x="395" y="670" class="small">price + metrics</text>

  <rect class="box" x="360" y="730" width="180" height="70" />
  <text x="420" y="760" class="label">score</text>
  <text x="400" y="780" class="small">FinSight score</text>

  <rect class="box" x="100" y="730" width="180" height="70" />
  <text x="140" y="760" class="label">draft</text>
  <text x="120" y="780" class="small">analysis writer</text>

  <rect class="box" x="100" y="620" width="180" height="70" />
  <text x="130" y="650" class="label">validate</text>
  <text x="120" y="670" class="small">quality checks</text>

  <rect class="box" x="100" y="510" width="180" height="70" />
  <text x="130" y="540" class="label">on_fail</text>
  <text x="125" y="560" class="small">retry routing</text>

  <rect class="box" x="360" y="820" width="180" height="60" />
  <text x="420" y="855" class="label">END</text>

  <path class="arrow" d="M450 150 L450 180" />
  <path class="arrow" d="M450 250 L450 290" />
  <path class="arrow" d="M450 360 L450 400" />
  <path class="arrow" d="M450 470 L450 510" />
  <path class="arrow" d="M450 580 L450 620" />
  <path class="arrow" d="M450 690 L450 730" />

  <path class="arrow" d="M360 765 L280 765" />
  <path class="arrow" d="M190 730 L190 690" />
  <path class="arrow" d="M190 620 L190 580" />
  <path class="arrow" d="M190 510 L190 470" />
  <path class="arrow" d="M190 470 L360 470" />

  <path class="arrow" d="M450 800 L450 820" />

  <path class="loop" d="M190 510 C190 360, 450 360, 450 250" />
  <text x="220" y="360" class="small" fill="#dc2626">retry loop on FAIL</text>
</svg>
